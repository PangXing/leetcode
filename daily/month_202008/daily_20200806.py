# coding:utf-8

class Solution(object):
    def is_palindrome(self, s):
        l = 0
        r = len(s) -1
        while l < r and s[l] == s[r]:
            l += 1
            r -= 1
        return l>=r

    def palindromePairs(self, words):
        n = len(words)
        res = list()
        visited = set()
        for i in range(n):
            for k in range(n):
                if i == k:
                    continue
                ni = len(words[i])
                nk = len(words[k])
                if ni == nk and (i in visited or k in visited):
                    continue
                if self.is_palindrome(words[i]+words[k]):
                    res.append([i, k])
                    if ni == nk:
                        res.append([k, i])
                        visited.add(i)
                        visited.add(k)
        return res

if __name__ == '__main__':
    solution = Solution()
    words = ["abcd","dcba","lls","s","sssll"]
    #words = ["bat","tab","cat"]
    words = ["hfjjh","jjhjadccehdaihaa","ghbjehbiiddcbdebj","aahidhgfcea","bijia","jiic","eiffbcjfbcicfid","hfjjffedfh","gjgfiid","cedhcbbhedh","adecahhchchajai","icdifcegdjjga","dbjdigebdagg","ffeifjbgbifcbf","jfahadehgieadidc","hcfjc","ddfgadabgjgcfdaijdgi","djia","bfceggbh","ajdjai","iiecied","g","bfehbhgfgdeecdcbedej","hcefjbagcgijbbgjgife","gaiebdc","gje","fidfaacd","hggacehhi","ageejgcbgid","hj","hag","iiaffaaaehb","jjhaieb","gcacjfaaadj","ggffd","jffi","bahhjfidheaedccfffe","hf","jafjhfdgccggifjija","bjfef","fc","iddghhac","jigghfcjabhcecfg","dfcieabdeeggi","gacaggdhbhfgafifbc","hedhijhe","chcaeib","dd","aiih","jifeacabhfcbajhjijad","jbicbcjajh","cjcejidihcfajadacbjc","d","bfdhedj","jefhhhee","idbbceai","cddfiebjchd","ihahbgebd","bjdcadjabgcfdfdfcgc","icahfjeebjejfbdjgbj","gigfafcccagc","jijfbhigj","dbe","ebagbaed","hhibeffg","ji","aiebbebheaca","hbggbdgjhb","jfhjfhegdcfh","dgjfjhciahbbcdcjhfj","cj","cgdgdibhb","c","jjcjcbcdbgcjjeddj","ghegjabhadgj","fjceibhighbd","ichcgbcdfjaiaf","icgechh","cbfdjihieghfdhjibba","daifafigfagec","ffedch","ef","idbfgddjdgfa","dieiaif","bjb","bfdabe","hhhbagcibjhea","eiddagijgg","cheffaacbebdbccggeg","fgichedjccf","ffijjab","ceee","bhgebijcehdejfd","ae","dgdb","ebahjaijdhj","eafh","hcbgg","i","dggig","fhhdcabagha","gageehc","ebgiabgjeehdgj","fdddhaacgbcj","gg","gaihbciajeiafjdbjac","bcecafibjhdia","icheeejchcehbchca","efj","hdghgdffbdedhbffaf","daj","hefdjhehhfbbgcgid","bdbif","gfahaffhbid","afjebfeceahh","abedaajaifcbhb","b","ddd","chjibehgbcf","agdfaidfdefi","iadcgaeh","hgchidfadicgjhfbac","aibhbcbfjacb","jdeihjghdjehgbadd","chddhhibfigihf","ga","daejabhibeggccggfh","gfdagiaeeaccdedfcgf","aagcdfehjgab","fbgcjbafgjj","cjbcfhfac","ededjagfejiegdfchj","dcffe","hcjihfjeeeibcacbd","dhagfdcb","adegificeaabihjcdc","a","gijgcja","hbihhb","dabhabdghhahh","ffceigijgchg","jgad","had","hicgecgj","bfjcchhaajjh","chdhbdcigedacgeffdi","ddiegiggaajhfhgj","fdihbfebh","ebfgdbgb","agegedabaj","aagdghihedbjd","begjcjijgcbbafjge","dif","edcib","cdgfadjhccbabdj","cc","fjcfdiehhac","bagdbcdf","ejgcahiffe","aje","j","iciffhe","chibehgbdaf","aj","eedggichbejacb","hjid","aiiaba","gjacfjdadjeia","ciibjhiafifjdj","eaihdeccfa","jccbchbei","ahhifgi","gbfafjfcaeihcahhggdf","jffejbbjhfbhhjhac","fa","jfcdfbffhjagceihih","deebdgegi","iaighgeeiehfgfafhg","h","cghe","jjhbfheig","gfgbfbfadiiehceiaih","hedcbajajfd","cjgeeibfaeedgjcibhi","iddcfejbhiibifh","eahabbgijfaf","hh","hfjibfgaffifgccbgf","ihdfaeechgifbedbd","chgfif","ja","dddjdbdddfgcb","aiaaahaaihf","hhhchaaegijebj","fdghbjdcfejdda","fjcgbf","dfaaghehcehiigcbighe","jejaajhajjaagjdcehj","jbagiighe","bcbcbabjac","iaegddagibac","hgaccdcggeigib","jgdcg","dbejdiabec","fhjgbaedf","jgbebjbhcidcdacdhaj","igefbg","eihebfej","f","bihdd","bcid","fbfffggaead","chdjfjjeba","dffdjegdecig","eaafjcdgbaaadjeedhia","degabdgfghabgihfhf","hfadbiaafadjj","ecgchabdhafhegghcfef","ibchci","hghjhhb","baebeehj","beaigbbha","ijebgb","gedf","jcdchfchjia","cgifgaejhhb","aeeiifdfbbfeee","ebdgcbihcgchhd","cghgicciccbih","gbdfabfffbc","fcbgabiadijagijdcdi","gfce","ghechaifhfifjefccj","jfaifgedgddhieebafei","ihej","bbccdeiiad","ibdgega","jgjfifidhihejdiehfgd","dgd","cdgheefihcbegd","aibahgdgaacgddcfhgde","fdehgafga","ebc","ec","aeeacaafiefhgihc","ajbahjcbbagd","bgbhbibgcbij","dbbbggiajhaf","habibjjfg","aigicbjbdgeajg","dac","hbdcfgii","jdhacfefji","fidja","jghah","egbb","aadejc","ddcebfdj","cig","ccacjgbce","jcedjajg","dhae","jfeadgce","af","abhfhcaaab","fbebjdd","bceei","ggadjfaiifd","agibaidbc","dhfjccjebegeb","abfce","jhjacfaabcb","cdcjahg","bejah","efbigehihhchcicg","cegihebijajejggddcdi","bgjjdddiegd","hbfghhfcjcjacegfa","cgicdahfgfeagaji","ghahgejbgiafj","chhfjbdichihjg","ehhbacaahcd","bbhgichfeabaaf","hd","aijacdjedhjeja","jhebaidjb","bjdfjigfghbeccc","gbagidh","dcgdebghfcde","deha","gcjjg","gcgeehghgddbeef","bhbjcfh","bjbhdjgifgea","dg","bgecib","iaegaab","gjabeddabffbbgffjfbi","fjhdcdjhf","gieegfa","hdacifdfefidibfjaj","fiacdbeifjd","aajhfeejibaaegdbcjbc","ejcbg","chihgcdchbhd","ccbaefeajdggdiab","ah","ibhe","dihigjeebcb","haifiidjbiggjgacgg","gcfdffi","jagdfcigdcjhaij","abjjecbgjafeagaief","iahdbedaihda","ihecjjeh","fbjjhgfjeda","feddbhghd","jefjjaajigbdg","ajhcidbbe","jghaaghdedjdae","bgcje","jgafgffebecacddjec","gghfedidhfhfgiddhgh","cjeeafbdfhfhgfhbeg","hfdecejiaice","cafihjeihf","beahdgejdfaccdeidebe","dhjcjegb","gdgegfihchec","icdhacfdfgej","jbcaabagegjjjgjeed","fhdecbdhbfgdfijjh","dcijiadheeebcddhha","fbhba","ighddcjifdgjhf","jbfidgb","fcafbgbbhdiijbehe","eibhgcc","fe","fghihiffhach","defb","ajaahidiecgchgdjai","fhga","gabgbaiiejcfhd","jfbbefaihebdbfee","e","affdgidf","ajijffcicadfaede","cbcijhjdbcaghig","badaecagbcjbehfihiia","ajdffgbbbe","gdidgjggbbcdjagfghc","egfdjcabicicgb","gbgfecihfffdajia","aehhafc","jghbda","ibidgcgdgfijdj","aijeeedfeedijegi","gfjchcbc","fghaefbdbccebehfecj","cifbiijbbhaeagaha","icheghdgbfaffefahg","gfajdhhhihiieb","hdiheccedehddhh","cgieidhegj","bb","eeeihaj","afadcbfbefdeadid","icchddijdfehi","cgicdifbefggae","ac","fhb","cifdfihe","fdcdafb","gj","aicbjfgigbbhafbcj","edaidgeajc","igibcjibbddedhchiegi","idgijefeicbffd","bddh","dfiibcbgeedbf","iifafgfcigghbbifajbh","hccfebgjeiegib","igcfghiejchgjcjdgi","efjijdag","jebjhiagejbh","aahgfdgghehbacjffhhb","fhhdiejhhijj","ccbgefjcjhef","gcecgfa","cdegibfcefggffa","ihcdbcagj","aegdgafddjebjfihc","fjhac","dabjefb","eaficegaehbjihejghjb","cbihhiigddbcbdjcj","gabiii","hebababgahfbghgcbg","ghjadeijhffjdgbfiia","cicgd","figcggdjddadagci","heacbabgg","ciciddcefbjfd","jcbgiaebgi","ecbbhfidfejeafad","fjgb","aja","ijhgbagjifgaba","jheegdbgafggbgacjhhh","aeafhjidejf","bggbbgbaec","gajaecggadghg","cjhhicjb","cjibjhiabajjba","gacjcceeccga","jehghhciaicg","jfej","ejbehjeccgbjhidc","gjgbaacgb","fbfagjjb","bfejaidcbebdieaajdc","bgfadcgcibea","fbjdfegegiehbfjiif","gcffdgeaffjadhbfgf","hiegdeggggdeieebi","afejga","eih","ffhjeggdgajfibghahfi","efihjjdfeedhcb","ggbjafaeccjfeaffiejd","dbfhdjfcfhjgaajbhf","gbgjhggfdeefcdjaahjf","hbgiecefdjcf","aeg","gbeadhaibaef","jfb","jjifbbfedb","aehadehfjgebgebchiac","eedaeaegbjajff","bc","iba","jihjeb","ejj","cggh","chbdjh","ejjf","gfhbhdfhibddebhgbha","idejbhah","bjgehibbagijbdgcg","jbegcjidecchghjb","fbbhidjiicbgjij","hfcdjjbhdh","gjffffddafa","cafijjjbgciefc","agdigcahhbhfefgccfff","hcbcfeifdfddgafgh","icgdjbgia","aeaifhagecacdiadgih","ejcihidifjdibdijb","jfbajg","igfjei","eebacgcdh","ccjcicgfiafhg","hffabiad","gfjdbijhb","dggcfeegdefcgibabb","igigeffdjch","ebccadcejbbdbjd","fagajedfeiibbbaba","facc","fcdddijdecbgf","jcgcijifaga","efaheihgd","iidcidedeeeac","bijaaacibeha","fedcehf","jcdjacdecjhcbajif","ii","bjfbhjhdfifeajbfi","hdacigggjghehfjffd","ejjdbgigfddfjfcfi","fhfdgbhg","fhdijh","gecfj","hbceadacedi","hdegea","bhacieg","gddcehdeb","bagb","babefafbicdhg","ehfcib","dajhjifhihggjcideije","ajgehdf","ehdjgdhfi","dedaeid","afegjibefjhajhc","jhfbjhhabbjbj","deai","iceaadgef","adgfdbhfgebg","ahdhcdgeajaaebc","djbbdgfbcdid","jffgfcijaa","edfdicedaijgbfdjfb","fafbagbggjjigfdhj","ejecjdbaaeda","ibcib","dfh","idcdjcdjhcigdcbidhch","jddfjdghchhbhahajbg","fiej","cfcdicafgagjfddhjig","cdefhjcicdicjheabfhj","hegjgcijhjhef","bddjgbcbbcgiiibahj","cfefdfbdhejch","hifijgifjjgd","bhijhebbcfhfd","djc","dhdg","fhhfhdicabg","aahhhhhhfdij","dbifbjdfde","iheagcgghbcbacch","jhccfghaiahghec","gfhdfahg","dbcjhddiadjbdihia","gihfccghehejdbbigi","cfjgadjfejc","hfjaheaij","eaiediddagbajhdibbeh","afceebehhcdgdgeagcjj","bbaiichig","eeabahbd","cacid","cbjjcbedaceejgfgbdd","fgddhbhccdbg","edieiibe","cjehcfbjgebgeijic","cdihdcbjdcchgiigff","jhdbhgcbhjabejhaac","abejecggcaa","hahaabdfachca","ehccgifccedabebaega","cdijehhdjhj","cffdhbedhhcjdc","hejigcideicacgigfgbh","hef","fehjdbdh","gjeh","aacifhaihcg","iecgbefdiachc","icdhjgei","befi","dfgcfgggd","dbifid","cebcfchhegahdif","gbc","edcbf","afajieajeahhgdj","hejifjhcjga","dabcddjfjiacadci","dii","gbbjegjaaabjeabfac","gib","beeehhdi","iciba","fjj","eagfcggaejgaach","ieecijcjgiejbdgcbjh","ccdbagejgjjj","bjgbieecjec","aiahagc","cihegbhcbjce","ehjahedejjcfdbdce","hiaifgffief","hjijbabh","beefcabjjhfhejfaijec","ihagfgejdfjdagedh","gefhgjiiiheijgjgfjd","ahf","afhdfbbccabagdijb","jiaaeaigbdfgcd","aaeagdfaiggbadbbdje","aacijjcbac","cfcecadih","aiihcbgacigagjai","eigece","eid","jdfccgbbjcgafeahhd","ceedfieafgefhjbeed","abbagibhcedahjee","deighgabjdigfd","fajd","egciijadbhfegdhd","bbbicigegeggajj","ecjegigbcbih","hbdbgghcbhg","babf","dgbbdefbbicedaebc","jbdejbdhiedjdgg","chghddidfabdcj","ifbahdciadfh","dfbibcgfhabcdadffh","bahcigdche","hjagiihgddiecfgb","bicgeegihbeaideaedb","chgfafdhhfdi","icjagciei","hbf","dadh","aafjicafadggjhfag","bjgahdifiddahbgc","cbf","hhgfeji","higjifecgcece","egffdfgjajefad","cihhcibf","aiifefj","fgiaceagd","fhbdjgbagiecaea","fdaje","ejhbfdecdijgbb","hjbicjjea","fjbibdcba","jidheejcicgidgbabggb","aegcjeehbgbhfdjagh","didjcfggcc","hcdbfjgfbfhd","ecbiij","bgebbjiehhbgahbaf","ghhgadjhbch","daggahhbdfg","dcfgfcb","hbaadgegjacf","jdfiajgchggfiiijbfib","jjedifggafdcfebihii","ic","fghd","abcbddhiebcie","baajeihgefbeheaiafb","bhbiggg","edejg","jcecfjcccejgdheaba","habcfehdjgfeh","jdbefaefbcagg","ibcfacefdehhbdcedj","ejiig","dihcbaeb","hfhafdbjeffdaccfh","fgabajabgjgi","hfgg","dfdaeabaijjfgbef","jdifcagfac","gjafcjahjaiagjfab","dcjdficcihfdbfed","ijbhdieji","ejddagihhghbd","aa","efa","fcffbdhdgejg","dhfggiffbfeiicb","gaghca","jiffbcgadeaec","gdfaih","edgbjgcac","jddefebjbgdhifdjheig","bieeccbcg","hfchjdfddgbbfebhehg","cebhdedfibdajc","ijgiiijjabhgehicjfa","jggajcbhd","bebbjeiigfchh","ijfdjfij","gabcdbi","ehcahai","jafieaihhdag","ahiiieijjbc","cggefea","fcigjchd","eihgfeg","aacifaegh","ejahacaddbfggfji","aahjijgecheajiaaa","dghdchaggfefbgie","idc","jbbc","ebbbibbdc","igdebjccidbahjggiai","ibidifhi","ejigdajjidgggijjhbfg","ggda","hajfjea","igihjijj","agjdccciefcg","feadbeeejjgibdegibbf","aideigbjh","diaibidffjajjaccej","adjdagb","beiiebaehhe","ggfgcjddeea","jdadfa","hjfhh","daadc","dhfhhd","dhiaejjeb","bigefgcgacbhebhcfj","gagbbjjfdfghfcddeei","ahfhhibaj","dedgb","aefafddcgdea","gjehjhie","dceai","jbbhbgdceihf","jfdiha","fedf","cgadgibba","jedchjcjggidbdefea","jbgi","di","hjgecgggcdjiecfadag","cajjcabbe","edgjfdjcbficf","ib","bheeigdcaieeedief","bgajcfiagiffbdhd","gicejbhcehaa","hfeahgeghdgi","adff","daiige","djcdejfbjcjc","jdhchdgfehgefjgb","eifihfajfhbebejj","beh","icjcf","debb","edhhbahcggf","gdjjjcbeaehiceicbe","jaabgadebfdicc","db","hegbejeajdhhegh","gdbebjfcebcfijefh","faiddebghgi","ajahfgbjgdjcjb","cbahbhibiffb","cebadha","hffebcbebifjaei","bhejf","jfgichiehff","deiafhja","bhgjbbfebaibhbgcg","efaicjecjaedc","dbfhfehcfbiegg","jehbcg","ggceacgchchfhchd","cjddjgbiddhh","bbcgeidhejjbaafceb","eeaefibabgdbc","bgciaafebhajbbdehf","ebfdbihggbbijhgeahd","ajadbcccifieccae","ffg","feijadcfcgbj","aejigjfbhchjhfbhgfeg","hbbe","efjabhcfibjbcae","hjfbfcahbieejgaaa","ageccfhdgcdfah","jfiieggcaacffecj","igehcdedfdjedhbc","fcebfacibggdeggjeigg","igcdg","ciajeegd","fghejejee","hgbajahhedicf","iaiiibigjhbfjfjjicab","jgacdi","eggdieeij","chae","ahhabhfaccgcehcfdjgc","jbbbfgiddeecgjgbefgf","fiagbejefhgaghbaibhc","ai","jbaiccfddeeafa","fijbhfbhijecbiijhga","dbfbaeefiihifbfbjed","eeefecjah","fdjedeghfjjfb","hciiiie","fch","ifdijicbieg","bib","agcgcfjcdfdiejcjjj","ehfcecjjaeagejdifdh","jgd","jhbbfbaecci","cagjfcifcjaheddc","jcfcghgi","jhddbj","djigjaieadfia","ebjfie","bggbcbbeghebgc","ijh","chaagejfabddcjgbgdd","gjfj","ahijcbcejbhifgdfiaej","aahbidcedh","faeaji","eafhi","babcbfidfgga","caahbefhghbfd","jgccdidchfhffijejac","aacg","ddhfbdfi","adjgefgiahdahiecgge","bgd","hjcjdi","hgdcbgjfbagcjdfg","hbjfi","iefhaefhgbdajjgdhbj","jeehadbbjidjb","hcc","bbfjfgggdbhhhjhbic","dfe","cfcadgaij","gageeddbddaj","jfgfhcgfc","hbgcfiieeed","hebdfefcdjj","baacajfeeg","figffccgecijfcechhb","bgijbabahjjaajic","caheegjdfdhgjf","gjggcaahibgfg","hfi","ififb","iaacbfa","jdegigghddbgjhdb","dicediahba","eddehcefacejda","edcgfhcgeee","cijhfdjfechjae","hhgcagjdbffgjadhe","caeedhjhfibjecggf","dedjbcdiahcbaabgeh","jhie","cciejcbcffeefhaid","hegfedgfceifcebehjc","hgihahdgad","chbfhc","ebdi","ghaacaaef","gafacaehghcifibjgi","cbiddcagc","dhhgjdaic","jaiddajhdidggfcdd","hicifcbhgeeej","fccjgcjjcdf","daafdjdgdiihdjf","biidhihjeajiidggjcg","ffiecghhjacjbec","didcchdibaihbe","hjigfbgejjjhabh","fae","cfgcgjcfjg","idbbe","jejabj","hfadfj","aifjhadicggdejghh","hgbheeahahdgghhg","acbbabac","eieaa","chhhdg","fcaabgdddgdbibhj","gbdcbihbhb","igiaghjbcejhaibe","gdcahdhgcgijcg","cidihiihjgffbdiej","aeicbgejf","cbcdeajijfb","bghdjdfccgeeej","iefdeeje","eibci","iegdfa","dcgjiebfahaecjefaga","iagehajcdjhejfb","caeaigcjhefehiiea","eihe","ccebcgeihiab","hcgdhbadecb","bfbgi","hffeadbi","ig","aeajifhgdcajeichidha","ihbicjaiefgafjjhh","dbdjbcgb","jd","cbabdjeegfbbjbgi","afcafjjhcg","edh","eaafcbhdjecd","ehbaicebjgcgie","ccffcjighfgieb","jciabfgfheaeab","iaddhadcjce","efgbdaedaeibahaee","cgihebjgfiafaibjdaj","cb","heibdgjebjf","cbjjaceab","adddggiec","hddcdd","cehajgfeeiafcejadh","cbacfbcacjjf","adjcjcahgfjiahie","jiehcebggfhabbca","hgddgcgbd","cfbjefi","iijhejejgijbe","ajchj","hihhbcbbgicajbbfc","gjgjfhgabbg","hgbbejcdagedieeigf","ihcafhfdhfafjadfd","dicfihcgbcbheg","ddbgifgj","gcefhjgcidagdbjg","bchifiajeihibg","fegeagdfajcabaajcfhd","djefhjbegbedhceejiic","ebijicdcfehaadachjig","hab","hfgf","hedgdaddaai","dcgaijgca","jjhebhjefcccij","dficjfha","eef","eheachfbfgicihafhb","icjehbbdjfiib","ijgfiichdbjbadfh","dfdjegdabbgfigaaggf","aeee","dacbachbaababia","cbdfijj","ajaccibh","cjeaagjgfgfe","cjciacajecdhcd","fceagdchfcbfb","gha","dfjjjcajihgjjfaj","hhahgdaejeaah","hecbgebifjhihidbif","iggdcabbi","gijfhbea","bdbfcfafchgea","ebccfacgggigg","cihaijcii","iccebccfbgffh"]
    print solution.palindromePairs(words)

